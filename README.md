# üß† Pi 5 Next.js Master Template (Bible)

Template ‡∏ï‡πâ‡∏ô‡πÅ‡∏ö‡∏ö‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ç‡∏∂‡πâ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö Web / API ‡∏ö‡∏ô Raspberry Pi 5 ‡∏î‡πâ‡∏ß‡∏¢‡∏£‡∏∞‡∏ö‡∏ö CI/CD ‡∏ó‡∏µ‡πà‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏á‡πà‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î

---

## üöÄ The Philosophy (‡∏Å‡∏é‡πÄ‡∏´‡∏•‡πá‡∏Å)

- **Docker Everywhere:** ‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏£‡∏±‡∏ô‡πÉ‡∏ô Container ‡∏´‡πâ‡∏≤‡∏°‡∏•‡∏á Runtime ‡∏ö‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á Host
- **Outside-In Config:** ‡πÑ‡∏ü‡∏•‡πå `.env` ‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ß‡πâ‡∏ó‡∏µ‡πà‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á Pi ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô (‡∏´‡πâ‡∏≤‡∏° Push ‡∏Ç‡∏∂‡πâ‡∏ô Git)
- **5-Minute Deploy:** ‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå‡πÉ‡∏´‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏ã‡πá‡∏ï‡∏≠‡∏±‡∏û‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 5 ‡∏ô‡∏≤‡∏ó‡∏µ

---

## üõ† Project Structure

| ‡πÑ‡∏ü‡∏•‡πå | ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ |
|------|----------|
| `Dockerfile` | Multi-stage (Standalone Mode) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î RAM/SSD ‡∏Ç‡∏≠‡∏á Pi 5 (~150MB) |
| `docker-compose.yml` | ‡πÉ‡∏ä‡πâ Environment Variables ‡∏Å‡∏≥‡∏´‡∏ô‡∏î Port ‡πÅ‡∏•‡∏∞‡∏ä‡∏∑‡πà‡∏≠ Container |
| `Jenkinsfile` | ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Pipeline, ‡∏î‡∏∂‡∏á `.env` ‡∏à‡∏≤‡∏Å Host ‡πÅ‡∏•‡∏∞‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ú‡πà‡∏≤‡∏ô Discord |
| `.env.example` | ‡∏ï‡πâ‡∏ô‡πÅ‡∏ö‡∏ö Environment Variables (‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÄ‡∏õ‡πá‡∏ô `.env` ‡πÅ‡∏•‡πâ‡∏ß‡πÅ‡∏Å‡πâ‡∏Ñ‡πà‡∏≤) |
| `next.config.js` | `output: 'standalone'` ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö image ‡πÄ‡∏•‡πá‡∏Å‡πÅ‡∏•‡∏∞‡∏£‡∏±‡∏ô `server.js` ‡πÑ‡∏î‡πâ |

---

## üîÑ Deployment Flow (‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô)

1. **Local Development:** ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î‡πÉ‡∏ô Cursor ‡πÅ‡∏•‡∏∞ `git push`
2. **GitHub Webhook:** ‡πÅ‡∏à‡πâ‡∏á‡πÑ‡∏õ‡∏ó‡∏µ‡πà Jenkins ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏Å‡∏≤‡∏£ Push
3. **Jenkins Pipeline:**
   - ‡∏î‡∏∂‡∏á‡πÇ‡∏Ñ‡πâ‡∏î‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏•‡∏á‡∏°‡∏≤‡∏ó‡∏µ‡πà Workspace
   - **‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç:** ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå `.env` ‡∏à‡∏≤‡∏Å‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå‡∏ö‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á Pi ‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡πÉ‡∏ô Workspace
   - ‡∏™‡∏±‡πà‡∏á `docker compose up --build -d` ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô
   - ‡∏•‡πâ‡∏≤‡∏á image ‡πÄ‡∏Å‡πà‡∏≤ (`docker image prune -f`) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î SSD
   - ‡∏™‡πà‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ (‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à/‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß) ‡πÄ‡∏Ç‡πâ‡∏≤ Discord Webhook

---

## ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô Local / Docker (‡∏ö‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á)

### Local (‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÅ‡∏ö‡∏ö‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ Docker)

```bash
cp .env.example .env
npm install
npm run dev
```

‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà `http://localhost:3000`

### Docker (‡∏ó‡∏î‡∏™‡∏≠‡∏ö Build ‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏±‡∏ô‡∏ö‡∏ô Pi 5 ‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á)

```bash
cp .env.example .env
# ‡πÅ‡∏Å‡πâ .env: PROJECT_NAME, HOST_PORT ‡∏ï‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
docker compose up -d --build
```

‡πÅ‡∏≠‡∏õ‡∏à‡∏∞‡∏£‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏û‡∏≠‡∏£‡πå‡∏ï‡∏ï‡∏≤‡∏° `HOST_PORT` ‡πÉ‡∏ô `.env`

---

## ‚ö°Ô∏è ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå‡πÉ‡∏´‡∏°‡πà (The 5-Minute Checklist)

‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏ß‡πá‡∏ö‡πÉ‡∏´‡∏°‡πà‡∏à‡∏≤‡∏Å Template ‡∏ô‡∏µ‡πâ ‡πÉ‡∏´‡πâ‡∏ó‡∏≥‡∏ï‡∏≤‡∏°‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ:

### 1. GitHub Setup

- ‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° **"Use this template"** ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á Repo ‡πÉ‡∏´‡∏°‡πà
- Clone ‡∏•‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÅ‡∏•‡∏∞‡πÄ‡∏õ‡∏¥‡∏î‡∏î‡πâ‡∏ß‡∏¢ Cursor

### 2. Configure Jenkinsfile

‡πÅ‡∏Å‡πâ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ô‡∏™‡πà‡∏ß‡∏ô `environment` ‡∏ó‡∏µ‡πà‡πÑ‡∏ü‡∏•‡πå `Jenkinsfile`:

```groovy
PROJECT_NAME = 'my-new-app'   // ‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå (‡∏´‡πâ‡∏≤‡∏°‡∏ã‡πâ‡∏≥)
HOST_PORT = '3001'            // Port ‡∏ö‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á Pi (‡∏´‡πâ‡∏≤‡∏°‡∏ã‡πâ‡∏≥)
HOST_ENV_PATH = "/home/symfy/projects/${PROJECT_NAME}/.env"
```

### 3. Prepare Pi 5 (One-time setup)

SSH ‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡∏ó‡∏µ‡πà Pi 5 ‡πÅ‡∏•‡∏∞‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏Å‡πá‡∏ö Config:

```bash
mkdir -p ~/projects/my-new-app
nano ~/projects/my-new-app/.env   # ‡πÉ‡∏™‡πà‡∏Ñ‡πà‡∏≤ Config ‡∏ï‡πà‡∏≤‡∏á‡πÜ ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà (PROJECT_NAME, HOST_PORT ‡∏Ø‡∏•‡∏Ø)
```

### 4. Jenkins Job Setup

- ‡∏™‡∏£‡πâ‡∏≤‡∏á **New Item** ‚Üí **Pipeline** ‡πÉ‡∏ô Jenkins
- ‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö `PROJECT_NAME`
- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å **Pipeline script from SCM** ‚Üí Git ‡πÅ‡∏•‡∏∞‡πÉ‡∏™‡πà URL ‡∏Ç‡∏≠‡∏á Repo ‡πÉ‡∏´‡∏°‡πà
- (Optional) ‡∏ï‡∏±‡πâ‡∏á **Webhook** ‡πÉ‡∏ô GitHub Settings ‡∏Ç‡∏≠‡∏á Repo

### 5. Final Push

```bash
git add .
git commit -m "chore: setup new project"
git push origin main
```

‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏ô‡∏±‡πâ‡∏ô Jenkins ‡∏à‡∏∞ Deploy ‡πÉ‡∏´‡πâ‡∏ï‡∏≤‡∏° Pipeline ‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á‡πÑ‡∏ß‡πâ

---

## üßπ Maintenance (‡∏Å‡∏≤‡∏£‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏£‡∏±‡∏Å‡∏©‡∏≤)

‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà SSD ‡∏Ç‡∏≠‡∏á Pi ‡∏°‡∏µ‡∏à‡∏≥‡∏Å‡∏±‡∏î ‡∏´‡∏≤‡∏Å Build ‡∏ö‡πà‡∏≠‡∏¢‡πÜ ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏≤‡∏à‡πÄ‡∏ï‡πá‡∏° ‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡∏¢‡∏∞ Docker:

```bash
docker system prune -a --volumes -f
```

‡πÉ‡∏ä‡πâ‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏∞‡∏°‡∏±‡∏î‡∏£‡∏∞‡∏ß‡∏±‡∏á: ‡∏à‡∏∞‡∏•‡∏ö image/container/volume ‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î

---

## ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏

- ‡∏™‡∏£‡πâ‡∏≤‡∏á `package-lock.json` ‡∏î‡πâ‡∏ß‡∏¢ `npm install` ‡πÅ‡∏•‡πâ‡∏ß commit ‡∏à‡∏∞‡∏ó‡∏≥‡πÉ‡∏´‡πâ Docker build ‡πÅ‡∏ö‡∏ö reproducible ‡∏î‡πâ‡∏ß‡∏¢ `npm ci`
- Discord Webhook ‡πÉ‡∏ô `Jenkinsfile` ‡∏Ñ‡∏ß‡∏£‡∏¢‡πâ‡∏≤‡∏¢‡πÑ‡∏õ‡πÉ‡∏ä‡πâ Jenkins Credentials ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢

---

**Happy Coding!** ‚Äî The Pi 5 Journey
